<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>B√†i ki·ªÉm tra Ph·ª•ng V·ª•</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
  body {
    font-family: 'Segoe UI', sans-serif;
    background-image: url('bukiphan.jpg'); /* ·∫£nh n·ªÅn b·∫°n t·∫£i l√™n */
    background-size: cover;          /* ·∫£nh ph·ªß to√†n m√†n h√¨nh */
    background-repeat: no-repeat;
    background-attachment: fixed;    /* c·ªë ƒë·ªãnh khi cu·ªôn */
    background-position: center;
    backdrop-filter: blur(2px);      /* l√†m m·ªù nh·∫π ph√≠a sau */
    margin: 0;
    padding: 0;
  }

  .quiz-box {
    max-width: 700px;
    margin: 50px auto;
    background: #dbeafe; /* üíô n·ªÅn xanh da tr·ªùi */
    border-radius: 12px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    padding: 30px;
  }

  .choice {
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    padding: 12px 16px;
    margin-bottom: 10px;
    background: #fff7ed; /* m√†u cam nh·∫°t */
    transition: 0.3s;
  }

  .choice:hover {
    background-color: #fde68a;
    cursor: pointer;
    transform: scale(1.02);
  }

  .choice.correct {
    background-color: #bbf7d0;
    border-color: #10b981;
    color: #065f46;
  }

  .choice.wrong {
    background-color: #fecaca;
    border-color: #ef4444;
    color: #7f1d1d;
  }

  .timer {
    font-weight: bold;
    color: #dc3545;
  }

  .blink {
    animation: blinkEffect 0.3s ease-in-out 3;
  }

  @keyframes blinkEffect {
    0%, 100% { opacity: 1; }
    50% { opacity: 0; }
  }
  h2.section-title {
    text-align: left;
    font-weight: bold;
    margin-bottom: 20px;
  }
</style>

</head>
<body>
  <div class="quiz-box">
    <h1 class="text-center mb-4 fw-bold">KI·ªÇM TRA 15'</h1>
    <h2 class="section-title">Ph·∫ßn I: Tr·∫Øc Nghi·ªám</h2>
    <div id="quiz-content"></div>
    <p class="timer text-center mt-3">Th·ªùi gian c√≤n l·∫°i: <span id="time">30</span> gi√¢y</p>
  </div>

  <script>
    // ======== TR·∫ÆC NGHI·ªÜM =========
    const questions = [
      { text: "C√¢u 1. M√πa Chay b·∫Øt ƒë·∫ßu khi n√†o?", choices: {A:"L·ªÖ Ch√∫a Gi√™su ch·ªãu Ph√©p R·ª≠a", B:"Th·ª© T∆∞ l·ªÖ Tro", C:"Th·ª© B·∫£y Tu·∫ßn Th√°nh", D:"T·∫•t c·∫£ ƒë·ªÅu sai"}, correct:"B" },
      { text: "C√¢u 2. M√πa V·ªçng g·ªìm 4 Ch√∫a Nh·∫≠t b·∫Øt ƒë·∫ßu t·ª´ Kinh chi·ªÅu I Ch√∫a Nh·∫≠t I M√πa V·ªçng ƒë·∫øn Kinh chi·ªÅu ng√†y n√†o?", choices: {A:"L·ªÖ Ch√∫a Gi√™su Ch·ªãu Ph√©p R·ª≠a", B:"Th·ª© T∆∞ l·ªÖ Tro", C:"V·ªçng l·ªÖ Gi√°ng Sinh", D:"V·ªçng l·ªÖ Ph·ª•c Sinh"}, correct:"C" },
      { text: "C√¢u 3. Trong M√πa Gi√°ng Sinh, ch√∫ng ta c·∫ßn ph·∫£i c√≥ t√¢m t√¨nh n√†o?", choices: {A:"H·∫øt l√≤ng c·∫£m t·∫° Thi√™n Ch√∫a l√† Cha, ƒë√£ th∆∞∆°ng sai Con M·ªôt ƒë·∫øn c·ª©u ƒë·ªô nh√¢n lo·∫°i", B:"Kh√¥ng ng·ª´ng c·ªông t√°c v·ªõi ∆°n Ch√∫a ƒë·ªÉ M·∫ßu nhi·ªám Gi√°ng Sinh ƒëem l·∫°i ∆°n c·ª©u ƒë·ªô cho b·∫£n th√¢n v√† cho m·ªçi ng∆∞·ªùi", C:"Lu√¥n canh t√¢n cu·ªôc s·ªëng ƒë·ªÉ ng√†y c√†ng n√™n x·ª©ng ƒë√°ng v·ªõi ∆°n c·ª©u ƒë·ªô Ch√∫a ban v√† n√™n con th·∫£o c·ªßa Ng∆∞·ªùi", D:"T·∫•t c·∫£ ƒë·ªÅu ƒë√∫ng"}, correct:"D" },
      { text: "C√¢u 4. L·ªÖ Ch√∫a Gi√™su ch·ªãu Ph√©p R·ª≠a ƒë∆∞·ª£c c·ª≠ h√†nh trong m√πa n√†o c·ªßa nƒÉm Ph·ª•ng v·ª•?", choices: {A:"M√πa V·ªçng", B:"M√πa Gi√°ng Sinh", C:"M√πa Chay", D:"M√πa Ph·ª•c Sinh"}, correct:"B" },
      { text: "C√¢u 5. Ph·ª•ng V·ª• C√¥ng Gi√°o g·ªìm c√°c m√πa n√†o?", choices: {A:"M√πa V·ªçng ‚Äì M√πa Gi√°ng Sinh ‚Äì M√πa Chay ‚Äì M√πa Ph·ª•c Sinh ‚Äì M√πa Th∆∞·ªùng Ni√™n", B:"M√πa V·ªçng ‚Äì M√πa Gi√°ng Sinh ‚Äì M√πa Chay ‚Äì M√πa Ph·ª•c Sinh ‚Äì M√πa T·∫° ∆†n", C:"M√πa Chay ‚Äì M√πa Gi√°ng Sinh ‚Äì M√πa V·ªçng ‚Äì M√πa Gieo H·∫°t ‚Äì M√πa L·ªÖ L√°", D:"M√πa V·ªçng ‚Äì M√πa Chay ‚Äì M√πa Gi√°ng Sinh ‚Äì M√πa Thu Ho·∫°ch ‚Äì M√πa Th∆∞·ªùng Ni√™n"}, correct:"A" },
      { text: "C√¢u 6. M√πa n√†o d∆∞·ªõi ƒë√¢y l√† th·ªùi gian H·ªôi Th√°nh chu·∫©n b·ªã t√¢m h·ªìn t√≠n h·ªØu tham d·ª± M·∫ßu nhi·ªám T·ª≠ n·∫°n - Ph·ª•c sinh c·ªßa ƒê·ª©c Kit√¥?", choices: {A:"M√πa V·ªçng", B:"M√πa Gi√°ng Sinh", C:"M√πa Chay", D:"M√πa Ph·ª•c Sinh"}, correct:"C" },
      { text: "C√¢u 7. M√πa V·ªçng l√† th·ªùi gian ng∆∞·ªùi t√≠n h·ªØu chu·∫©n b·ªã t√¢m h·ªìn x·ª©ng ƒë√°ng ƒë·ªÉ l√†m g√¨?", choices: {A:"ƒê√≥n ch·ªù v√† m·ª´ng Ch√∫a Kit√¥ ƒë·∫øn l·∫ßn th·ª© nh·∫•t (ƒê·∫°i l·ªÖ Gi√°ng Sinh) t·∫°i B√™lem x·ª© Palestina", B:"H√¢n hoan v√¨ Ch√∫a Kit√¥ ƒë√£ chi·∫øn th·∫Øng s·ª± ch·∫øt ƒë·ªÉ s·ªëng l·∫°i vinh hi·ªÉn", C:"T·ªânh th·ª©c v√† s·∫µn s√†ng ƒë√≥n ch·ªù Ch√∫a ƒë·∫øn l·∫ßn th·ª© hai trong vinh quang (ng√†y quang l√¢m, ng√†y c√°nh chung)", D:"C·∫£ A v√† C ƒë·ªÅu ƒë√∫ng"}, correct:"D" },
      { text: "C√¢u 8. M√πa n√†o l√† th·ªùi gian H·ªôi Th√°nh h√¢n hoan m·ª´ng k√≠nh M·∫ßu nhi·ªám Nh·∫≠p th·ªÉ, Con Thi√™n Ch√∫a ƒë·∫øn ng·ª± gi·ªØa tr·∫ßn gian?", choices: {A:"M√πa V·ªçng", B:"M√πa Gi√°ng Sinh", C:"M√πa Chay", D:"M√πa Ph·ª•c Sinh"}, correct:"B" },
      { text: "C√¢u 9. T∆∞ th·∫ø s·∫µn s√†ng v√† t·ªânh th·ª©c trong M√πa V·ªçng ƒë∆∞·ª£c di·ªÖn t·∫£ nh∆∞ th·∫ø n√†o?", choices: {A:"S·ªëng ngay th·∫≥ng th·∫≠t th√†, kh√¥ng d·ªëi tr√° gian ngoa, nh∆∞ng h·∫øt l√≤ng suy ph·ª•c Thi√™n Ch√∫a qua ti·∫øng n√≥i c·ªßa l∆∞∆°ng t√¢m v√† l·ªùi H·ªôi Th√°nh d·∫°y b·∫£o", B:"Kh√¥ng thi·∫øu s√≥t vi·ªác b·ªïn ph·∫≠n, s·ª≠a ch·ªØa nh·ªØng khuy·∫øt ƒëi·ªÉm nh∆∞ gi·∫≠n h·ªùn, o√°n gh√©t, t·ªã hi·ªÅm", C:"D·ª©t kho√°t xa l√°nh ki√™u ng·∫°o, t·ª± cao, ∆∞∆°ng ng·∫°nh, khinh mi·ªát b·∫°n b√®‚Ä¶", D:"T·∫•t c·∫£ ƒë·ªÅu ƒë√∫ng"}, correct:"D" },
      { text: "C√¢u 10. Sau khi ch·ªãu Ph√©p R·ª≠a t·∫°i s√¥ng Gio-ƒëan, Ch√∫a Gi√™su ƒëi ƒë√¢u?", choices: {A:"Ch√∫a Gi√™su rao gi·∫£ng Tin M·ª´ng t·∫°i Ga-li-l√™", B:"Ch√∫a Gi√™su ƒÉn chay r√≤ng r√£ 40 ƒë√™m ng√†y trong hoang ƒë·ªãa", C:"Ch√∫a Gi√™su ti·∫øn v√†o ƒë·ªÅn th·ªù Gi√™-ru-sa-lem", D:"T·∫•t c·∫£ ƒë·ªÅu sai"}, correct:"B" }
    ];

    const essayQuestion = {
      text: "Ph·ª•ng v·ª• l√† g√¨?",
      keywords: [
        { word: ["th·ªù ph∆∞·ª£ng Thi√™n Ch√∫a"], point: 2 },
        { word: ["c√¥ng khai"], point: 1.5 },
        { word: ["ch√≠nh th·ª©c"], point: 1.5 }
      ],
      sample: "Ph·ª•ng v·ª• l√† vi·ªác th·ªù ph∆∞·ª£ng Thi√™n Ch√∫a c√¥ng khai v√† ch√≠nh th·ª©c c·ªßa to√†n th·ªÉ H·ªôi Th√°nh."
    };

    let current = 0, scoreChoice = 0, timer, timeLeft = 30;
    let userAnswers = []; // l∆∞u c√¢u tr·∫£ l·ªùi tr·∫Øc nghi·ªám
    const quizContent = document.getElementById("quiz-content");
    const timeDisplay = document.getElementById("time");

    function startTimer() {
      clearInterval(timer);
      timeLeft = 30;
      timeDisplay.textContent = timeLeft;
      timer = setInterval(() => {
        timeLeft--;
        timeDisplay.textContent = timeLeft;
        if(timeLeft <= 0) { clearInterval(timer); nextQuestion(); }
      }, 1000);
    }

    function loadQuestion() {
      const q = questions[current];
      quizContent.innerHTML = `<h5>${q.text}</h5><div class="mt-3">
        ${Object.entries(q.choices).map(([k,v]) => `<div class="choice" data-key="${k}"><strong>${k}.</strong> ${v}</div>`).join('')}
      </div>`;
      document.querySelectorAll(".choice").forEach(btn => {
        btn.addEventListener("click", ()=>handleAnswer(btn.dataset.key, btn));
      });
      startTimer();
    }

    function handleAnswer(selectedKey, element) {
  clearInterval(timer);
  const q = questions[current];
  userAnswers.push({ question: q.text, selected: selectedKey, correct: q.correct });

  const allChoices = document.querySelectorAll(".choice");
  allChoices.forEach(btn => {
    btn.style.pointerEvents = "none";
    if (btn.dataset.key === q.correct) btn.classList.add("correct");
    else if (btn.dataset.key === selectedKey) btn.classList.add("wrong");
  });

  // N·∫øu ƒë√∫ng, c·ªông ƒëi·ªÉm
  if (selectedKey === q.correct) scoreChoice++;

  // Hi·ªáu ·ª©ng nh·∫•p nh√°y ƒë√°p √°n ƒë√∫ng 3 l·∫ßn
  const correctEl = [...allChoices].find(btn => btn.dataset.key === q.correct);
  correctEl.classList.add("blink");

  // Sau khi nh·∫•p nh√°y xong (kho·∫£ng 900ms), chuy·ªÉn c√¢u
  setTimeout(nextQuestion, 900);
}


    function nextQuestion() {
      current++;
      if(current < questions.length) loadQuestion();
      else showEssayPart();
    }

    // ======== T·ª∞ LU·∫¨N =========
    function showEssayPart() {
      document.querySelector(".timer").style.display = "none";
      document.querySelector(".section-title").textContent = "PH·∫¶N II: T·ª∞ LU·∫¨N";
      quizContent.innerHTML = `<h5>${essayQuestion.text}</h5>
        <textarea id="essay" class="form-control mt-3" rows="4" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi c·ªßa b·∫°n..."></textarea>
        <button id="submitEssay" class="btn btn-primary mt-3 w-100">N·ªôp b√†i</button>`;
      document.getElementById("submitEssay").addEventListener("click", checkEssay);
    }

    function checkEssay() {
      document.querySelector(".section-title").style.display = "none";
      const ans = document.getElementById("essay").value.toLowerCase();
      let essayScore = 0;
      essayQuestion.keywords.forEach(item => {
        if(item.word.every(w => ans.includes(w))) essayScore += item.point;
      });
      if(essayScore > 5) essayScore = 5;
      const choiceScore = (scoreChoice / questions.length) * 5;
      const total = (choiceScore + essayScore).toFixed(2);

      // ======== HI·ªÇN TH·ªä K·∫æT QU·∫¢ & XEM L·∫†I B√ÄI =========
      quizContent.innerHTML = `<h4 class="text-center text-success mb-3">Ho√†n th√†nh b√†i ki·ªÉm tra!</h4>
        <p class="text-center fs-5">ƒêi·ªÉm tr·∫Øc nghi·ªám: ${choiceScore.toFixed(2)}/5</p>
        <p class="text-center fs-5">ƒêi·ªÉm t·ª± lu·∫≠n: ${essayScore}/5</p>
        <hr>
        <p class="text-center fw-bold fs-4">T·ªïng ƒëi·ªÉm: ${total}/10</p>
        <h5 class="mt-4">Xem l·∫°i b√†i l√†m:</h5>
        ${questions.map((q,i)=>`
          <div class="answer-box">
            <p><strong>${q.text}</strong></p>
            <p>C√¢u tr·∫£ l·ªùi c·ªßa b·∫°n: <strong>${q.choices[userAnswers[i].selected]}</strong></p>
            <p>ƒê√°p √°n ƒë√∫ng: <strong>${q.choices[q.correct]}</strong></p>
          </div>
        `).join('')}
        <div class="answer-box">
          <p><strong>${essayQuestion.text}</strong></p>
          <p>C√¢u tr·∫£ l·ªùi c·ªßa b·∫°n: <strong>${ans}</strong></p>
          <p>ƒê√°p √°n m·∫´u: <strong>${essayQuestion.sample}</strong></p>
        </div>
        <div class="text-center mt-3">
          <button class="btn btn-secondary" onclick="location.reload()">L√†m l·∫°i</button>
        </div>`;
    }

    // ======== KH·ªûI T·∫†O =========
    loadQuestion();
  </script>
</body>
</html>
